\input{../hwk_header.tex}

%\setlength{\headsep}{-10pt}
\setlength{\parskip}{0.2em}
%\setlength{\textheight}{11 in}
\setlength{\skip\footins}{20pt}

% Homework Specific Information
\newcommand{\hmwkClass}{ASTR 400B}
\newcommand{\hmwkTitle}{Homework 4}
\newcommand{\hmwkDueDate}{Feb 13, 2020}

\hyphenpenalty=1000

\begin{document}
	
\maketitle

This document is a summary. Top-level calculations are in Homework4/Homework4.ipynb and the class files which do most of the work are in source/galaxy/*.py.

\section*{1) COM Position and Velocity}

These are the results for the three galaxies, using only disk particles:\\

{\centering{\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|cc|ccc|ccc|cc|}
	\hline
	\textbf{name} & \textbf{ptype} & \textbf{x} & \textbf{y} & \textbf{z} & \textbf{vx} & \textbf{vy} & \textbf{vz} & \textbf{R} & \textbf{V} \\
	&  & $\mathrm{kpc}$ & $\mathrm{kpc}$ & $\mathrm{kpc}$ & $\mathrm{km\,s^{-1}}$ & $\mathrm{km\,s^{-1}}$ & $\mathrm{km\,s^{-1}}$ & $\mathrm{kpc}$ & $\mathrm{km\,s^{-1}}$ \\
	\hline
	MW\_000 & disk & -2.07 & 2.95 & -1.45 & 0.94 & 6.32 & -1.35 & 3.88 & 6.53 \\
	M31\_000 & disk & -377.66 & 611.43 & -284.64 & 72.85 & -72.14 & 49.0 & 772.98 & 113.63 \\
	M33\_000 & disk & -476.22 & 491.44 & -412.4 & 44.42 & 101.78 & 142.23 & 798.98 & 180.45 \\
	\hline
\end{tabular}} \par}\vspace{5mm}

So for the Milky Way: \\
The position vector is $\left< -2.07,\ 2.95,\ -1.45\right>$ kpc\\
The velocity vector is $\left<0.94,\ 6.32,\ -1.35 \right>$ km/s

Both are small compared with M31 and M33, reflecting the choice of our galaxy as the origin in this sim.

\section*{2, 3) Relative Position and Velocity}

We can get the relative position vector by subtraction: $\mathbf{r}_{1 \rightarrow 2} = \mathbf{r}_2 - \mathbf{r}_1$ and similarly for velocity. For example, M31 as seen from the Milky Way has relative position vector $\left< -375.59,  608.48, -283.19 \right>$ kpc.

More usefully, the norm of the position vector gives the separation distance: $|\mathbf{r}_{1 \rightarrow 2}| = R_{1,2}$. 

For velocity, we really want to separate the radial and tangential components:
\[ v_r = \mathbf{\hat{r}} \cdot \mathbf{v} \qquad \text{and} \qquad v_t = | \mathbf{\hat{r}} \times \mathbf{v} |  \qquad \text{where} \qquad \mathbf{\hat{r}} = \frac{\mathbf{r}}{|\mathbf{r}|} \]

{\centering{\renewcommand{\arraystretch}{1.3}
\begin{tabular}{cccc}
	\toprule
	\textbf{pairs} & \textbf{Separation ($R$)} & \textbf{Radial velocity ($v_r$)} & \textbf{Tangential velocity ($v_t$)} \\
	& $\mathrm{kpc}$ & $\mathrm{km\,s^{-1}}$ & $\mathrm{km\,s^{-1}}$ \\
	\midrule
	MW $\rightarrow$ M31 & 769.10 & -115.85 & 21.36 \\
	M31 $\rightarrow$ M33 & 201.08 & -150.09 & 132.69 \\
	\bottomrule
\end{tabular}} \par}\vspace{5mm}

In these coordinates, radial velocity would be positive for separation increasing with time. The results show that M31 is heading fairly directly towards the MW (blue shifted) and M33 is heading towards M31 (but with a large tangential component).

\section*{4) Why Iterate?}

When galaxies merge (as these will in future homeworks), some stars/gas/dust/whatever are ejected and are no longer gravitationally bound. 

We don't want to include these in the COM determination where their distance would give them a large weight. Iterating over successively smaller radii removes them from this calculation without losing them from the overall simulation.

\end{document}
